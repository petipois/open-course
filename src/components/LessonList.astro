---
import Progress from "./starwind/progress";
const { lessons, lessonProgress } = Astro.props;

// Sort lessons by the 'order' field (ascending)
const sortedLessons = lessons.slice().sort((a:any, b:any) => a.order - b.order);
---

<aside class="w-64 bg-white shadow-lg border-r border-gray-100 p-6">
  <h2 class="text-2xl font-semibold text-gray-800 mb-6">📘 Lessons</h2>
  <ul id="lessonList" class="space-y-3">
    {sortedLessons.map((lesson:any) => (
      <li
        class={`group cursor-pointer p-2 rounded ${
          lessonProgress[lesson.$id] ? "bg-green-50 border-l-4 border-green-500" : ""
        }`}
        data-lesson-id={lesson.$id}
        data-title={lesson.title}
        data-description={lesson.description}
        data-video-id={lesson.videoID}
        data-completed={lessonProgress[lesson.$id]}
      >
        <div class="flex justify-between items-center">
          <span class="font-medium">{lesson.title}</span>
          <span class="text-xs text-gray-500">
            {lessonProgress[lesson.$id] ? "✔️" : "0%"}
          </span>
        </div>
        <Progress value={lessonProgress[lesson.$id] ? 100 : 0} />
      </li>
    ))}
  </ul>
</aside>
